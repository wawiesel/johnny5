#!/bin/bash

set -euo pipefail

ROOT_DIR=$(cd "$(dirname "$0")/.." && pwd)
cd "$ROOT_DIR"

echo "ðŸŽ¨ Web checks (ESLint + Playwright)"

if ! command -v npx >/dev/null 2>&1; then
  echo "âŒ Node.js/npm not found. Install Node to run web checks." >&2
  exit 1
fi

if [ ! -d "node_modules" ]; then
  echo "âŒ node_modules missing. Run 'npm ci' (or npm install) first." >&2
  exit 1
fi

if [ -f "$ROOT_DIR/eslint.config.cjs" ]; then
  echo "â–¶ ESLint"
  npx --yes eslint "src/johnny5/web/static/**/*.js"
  echo "âœ… ESLint passed"
else
  echo "â„¹ï¸  ESLint config not present; skipping lint" >&2
fi

if [ -x "$ROOT_DIR/scripts/pre-commit-playwright-tests" ]; then
  echo "â–¶ Playwright"
  "$ROOT_DIR/scripts/pre-commit-playwright-tests"
else
  echo "â„¹ï¸  Playwright helper script not present; skipping e2e" >&2
fi

exit 0


